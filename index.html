<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Pasta-kunのチャット</title>
  </head>
  <body>
    <br>名前</br>
    <input type="text" name="name"></p>
    <br>文章</br>
    <input type="text" name="text"></p>
    <input type="button" value="送信" onclick="send()">
    <div id="textbox">
    </div>
    <script>
var uri = 'wss://192.168.0.40:10005';
var connection;

window.onload = function () {
  connection = new WebSocket(uri);
  connection.onopen = onOpen;
  connection.onmessage = onMessage;
}

function onOpen(event) {
  console.log("Connect successful!");
}

function onMessage(event) {
  //Incoming data
  let text = document.createElement('p');
  text.prepend(event.data);
  let textbox = document.getElementById('textbox');
  textbox.prepend(text);
}
function send(){
  connection.send(`${document.getElementsByName('name')[0].value}: ${document.getElementsByName('text')[0].value}`);
}
    </script>
  </body>
</html>
